
http://cvs.openssl.org/chngview?cn=22547
http://openssl.org/news/secadv_20120510.txt

--- ssl/d1_enc.c	2011-01-04 19:33:22.000000000 +0000
+++ ssl/d1_enc.c.oden	2012-05-11 09:49:13.000000000 +0000
@@ -260,7 +260,7 @@ int dtls1_enc(SSL *s, int send)
 				}
 			/* TLS 1.0 does not bound the number of padding bytes by the block size.
 			 * All of them must have value 'padding_length'. */
-			if (i > (int)rec->length)
+			if (i + bs > (int)rec->length)
 				{
 				/* Incorrect padding. SSLerr() and ssl3_alert are done
 				 * by caller: we don't want to reveal whether this is
