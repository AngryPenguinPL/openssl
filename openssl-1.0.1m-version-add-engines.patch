--- openssl-1.0.1m/apps/version.c.orig	2015-03-20 23:55:56.104210115 +0000
+++ openssl-1.0.1m/apps/version.c	2015-03-20 23:58:02.422216130 +0000
@@ -140,7 +140,7 @@
 int MAIN(int argc, char **argv)
 {
     int i, ret = 0;
-    int cflags = 0, version = 0, date = 0, options = 0, platform = 0, dir = 0;
+    int cflags = 0, version = 0, date = 0, options = 0, platform = 0, dir = 0, engines = 0;
 
     apps_startup();
 
@@ -164,7 +164,7 @@
         else if (strcmp(argv[i], "-d") == 0)
             dir = 1;
         else if (strcmp(argv[i], "-a") == 0)
-            date = version = cflags = options = platform = dir = 1;
+            date = version = cflags = options = platform = dir = engines = 1;
         else {
             BIO_printf(bio_err, "usage:version -[avbofpd]\n");
             ret = 1;
@@ -208,6 +208,17 @@
         printf("%s\n", SSLeay_version(SSLEAY_CFLAGS));
     if (dir)
         printf("%s\n", SSLeay_version(SSLEAY_DIR));
+    if (engines) {
+        ENGINE *e;
+        printf("engines:  ");
+        e = ENGINE_get_first();
+        while (e) {
+           printf("%s ", ENGINE_get_id(e));
+           e = ENGINE_get_next(e);
+        }
+        printf("\n");
+    }
+
  end:
     apps_shutdown();
     OPENSSL_EXIT(ret);
